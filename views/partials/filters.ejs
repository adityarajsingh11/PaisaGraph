<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Finance Filter Section</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
    }
    
    .input-focus {
      transition: all 0.3s ease;
    }
    
    .input-focus:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      transform: translateY(-1px);
    }
    
    .filter-card {
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      border: 1px solid #e2e8f0;
    }
    
    .section-title {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .icon-badge {
      background: linear-gradient(135deg, #3b82f620 0%, #8b5cf620 100%);
      border: 1px solid #3b82f640;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      transition: all 0.3s ease;
    }
    
    .btn-secondary:hover {
      background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .chart-container {
      background: white;
      border: 2px dashed #e2e8f0;
      border-radius: 1rem;
      position: relative;
      overflow: hidden;
    }
    
    .chart-container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(59, 130, 246, 0.05), transparent);
      transform: rotate(45deg);
      pointer-events: none;
    }
    
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
      transition: all 0.2s ease;
    }
    
    .badge:hover {
      transform: scale(1.05);
    }
    
    @keyframes pulse-subtle {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    
    .pulse-badge {
      animation: pulse-subtle 2s ease-in-out infinite;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 p-6">

  <section class="filter-card rounded-2xl shadow-lg p-6 space-y-6 max-w-7xl mx-auto transition-all duration-300 hover:shadow-xl">
    
    <!-- Section Header -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 pb-4 border-b border-slate-200">
      <div class="flex items-center gap-3">
        <div class="icon-badge p-2.5 rounded-xl">
          <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
          </svg>
        </div>
        <div>
          <h2 class="section-title text-xl font-bold">Filters & Analytics</h2>
          <p class="text-xs text-slate-500 mt-0.5">Refine your financial insights</p>
        </div>
      </div>
      
      <!-- Active Filters Badge -->
      <div class="badge bg-blue-50 text-blue-700 border border-blue-200 pulse-badge">
        <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
        </svg>
        <span id="activeFiltersCount">0 Active Filters</span>
      </div>
    </div>

    <!-- Filter Controls -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      
      <!-- Date Range -->
      <div class="space-y-2">
        <label class="flex items-center gap-2 text-xs font-semibold text-slate-600 uppercase tracking-wide">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
          Start Date
        </label>
        <input type="date" id="startDate" class="input-focus w-full border-2 border-slate-200 rounded-xl p-3 text-sm font-medium text-slate-700 bg-white hover:border-slate-300">
      </div>

      <div class="space-y-2">
        <label class="flex items-center gap-2 text-xs font-semibold text-slate-600 uppercase tracking-wide">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
          End Date
        </label>
        <input type="date" id="endDate" class="input-focus w-full border-2 border-slate-200 rounded-xl p-3 text-sm font-medium text-slate-700 bg-white hover:border-slate-300">
      </div>

      <!-- Type Filter -->
      <div class="space-y-2">
        <label class="flex items-center gap-2 text-xs font-semibold text-slate-600 uppercase tracking-wide">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
          </svg>
          Type
        </label>
        <select id="typeFilter" class="input-focus w-full border-2 border-slate-200 rounded-xl p-3 text-sm font-medium text-slate-700 bg-white hover:border-slate-300 cursor-pointer">
          <option value="">All Types</option>
          <option value="income">üí∞ Income</option>
          <option value="expense">üí∏ Expense</option>
        </select>
      </div>

      <!-- Category Filter -->
      <div class="space-y-2">
        <label class="flex items-center gap-2 text-xs font-semibold text-slate-600 uppercase tracking-wide">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
          </svg>
          Category
        </label>
        <select id="categoryFilter" class="input-focus w-full border-2 border-slate-200 rounded-xl p-3 text-sm font-medium text-slate-700 bg-white hover:border-slate-300 cursor-pointer">
          <option value="">All Categories</option>
          <option>üíº Salary</option>
          <option>üçî Food</option>
          <option>üí° Utilities</option>
          <option>üöó Transport</option>
          <option>üì¶ Others</option>
        </select>
      </div>

      <!-- Search -->
      <div class="space-y-2 md:col-span-2 lg:col-span-2">
        <label class="flex items-center gap-2 text-xs font-semibold text-slate-600 uppercase tracking-wide">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          Search
        </label>
        <div class="relative">
          <input id="q" placeholder="Search by title or notes..." class="input-focus w-full border-2 border-slate-200 rounded-xl p-3 pl-10 text-sm font-medium text-slate-700 bg-white hover:border-slate-300">
          <svg class="w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="space-y-2 md:col-span-2 lg:col-span-2 xl:col-span-2">
        <label class="flex items-center gap-2 text-xs font-semibold text-slate-600 uppercase tracking-wide">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
          Actions
        </label>
        <div class="flex gap-3">
          <button id="applyFilter" class="btn-primary flex-1 text-white px-6 py-3 rounded-xl text-sm font-semibold shadow-lg active:scale-95 flex items-center justify-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            Apply Filters
          </button>
          <button id="exportExcel" class="btn-secondary px-6 py-3 rounded-xl text-sm font-semibold text-slate-700 shadow-md active:scale-95 flex items-center justify-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            Export to Excel
          </button>
        </div>
      </div>
    </div>

    <!-- Chart Section -->
    <div class="pt-4">
      <div class="flex items-center gap-3 mb-4">
        <div class="icon-badge p-2 rounded-xl">
          <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path>
          </svg>
        </div>
        <h3 class="text-lg font-bold text-slate-800">Spending Distribution</h3>
        <div class="badge bg-emerald-50 text-emerald-700 border border-emerald-200 ml-auto">
          <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
          </svg>
          Live Data
        </div>
      </div>
      
      <div class="chart-container p-6 h-72 flex items-center justify-center">
        <canvas id="pieChart"></canvas>
      </div>
    </div>

  </section>

  <script>
    // Export to Excel functionality
    document.getElementById('exportExcel').addEventListener('click', function() {
      // Get transaction data (you'll need to replace this with your actual data source)
      // This is a sample - you should fetch from your actual transactions array
      const transactions = getTransactionsData(); // Replace with your data fetching method
      
      if (!transactions || transactions.length === 0) {
        alert('No transactions to export');
        return;
      }
      
      // Create worksheet data
      const wsData = [
        ['Transaction Report'], // Title
        ['Generated on: ' + new Date().toLocaleString()], // Date
        [], // Empty row
        ['Title', 'Amount', 'Type', 'Category', 'Date', 'Description'] // Headers
      ];
      
      // Add transaction rows
      transactions.forEach(transaction => {
        wsData.push([
          transaction.title || '',
          transaction.amount || 0,
          transaction.type || '',
          transaction.category || '',
          transaction.date || '',
          transaction.description || ''
        ]);
      });
      
      // Add summary at the end
      wsData.push([]);
      wsData.push(['Summary']);
      const totalIncome = transactions
        .filter(t => t.type === 'income')
        .reduce((sum, t) => sum + (parseFloat(t.amount) || 0), 0);
      const totalExpense = transactions
        .filter(t => t.type === 'expense')
        .reduce((sum, t) => sum + (parseFloat(t.amount) || 0), 0);
      
      wsData.push(['Total Income', totalIncome]);
      wsData.push(['Total Expense', totalExpense]);
      wsData.push(['Net Balance', totalIncome - totalExpense]);
      
      // Create workbook and worksheet
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(wsData);
      
      // Set column widths
      ws['!cols'] = [
        { wch: 20 }, // Title
        { wch: 12 }, // Amount
        { wch: 10 }, // Type
        { wch: 15 }, // Category
        { wch: 12 }, // Date
        { wch: 30 }  // Description
      ];
      
      // Style the header row (row 4, index 3)
      const headerCells = ['A4', 'B4', 'C4', 'D4', 'E4', 'F4'];
      headerCells.forEach(cell => {
        if (ws[cell]) {
          ws[cell].s = {
            font: { bold: true },
            fill: { fgColor: { rgb: "4472C4" } },
            alignment: { horizontal: "center" }
          };
        }
      });
      
      // Add worksheet to workbook
      XLSX.utils.book_append_sheet(wb, ws, 'Transactions');
      
      // Generate filename with current date
      const filename = `transactions_${new Date().toISOString().split('T')[0]}.xlsx`;
      
      // Save file
      XLSX.writeFile(wb, filename);
      
      // Show success message
      showNotification('Excel file downloaded successfully!');
    });
    
    // Helper function to show notification
    function showNotification(message) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 0.75rem;
        box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        z-index: 9999;
        animation: slideInRight 0.3s ease-out;
      `;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease-out';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }
    
    // This function should be replaced with your actual data fetching logic
    function getTransactionsData() {
      // Example: Return transactions from your global variable or fetch from DOM
      // For demonstration, returning sample data
      
      // If you have transactions in the DOM, you can extract them:
      /*
      const transactionElements = document.querySelectorAll('.transaction-item');
      return Array.from(transactionElements).map(el => ({
        title: el.querySelector('.transaction-title')?.textContent || '',
        amount: el.querySelector('.transaction-amount')?.textContent || '0',
        type: el.classList.contains('income-item') ? 'income' : 'expense',
        category: el.querySelector('.category-chip')?.textContent || '',
        date: el.querySelector('.transaction-date')?.textContent || '',
        description: el.querySelector('.transaction-description')?.textContent || ''
      }));
      */
      
      // Or if you have a global transactions array:
      // return window.transactions || [];
      
      // Sample data for demonstration:
      return [
        {
          title: 'Monthly Salary',
          amount: 45000,
          type: 'income',
          category: 'Salary',
          date: '2025-10-15',
          description: 'Monthly salary payment'
        },
        {
          title: 'Grocery Shopping',
          amount: 2450,
          type: 'expense',
          category: 'Food',
          date: '2025-10-18',
          description: 'Weekly groceries'
        }
      ];
    }
  </script>
  
  <style>
    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOutRight {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
  </style>

</body>
</html>